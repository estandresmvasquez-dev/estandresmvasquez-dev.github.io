<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islas de Conocimiento - Hominidos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- GENERALES Y TEMÁTICOS --- */
        body {
            font-family: 'Cinzel', serif;
        }
        /* Color de fondo degradado (Estable) */
        .bg-gradient-sky-desert {
            background: linear-gradient(to bottom, #D4C3A6 0%, #8A6D56 100%); 
        }

        /* --- ANIMACIONES GLOBALES --- */
        /* AJUSTE DE LA ANIMACIÓN DEL TÍTULO PARA QUE SEA SÓLO ESCALA */
        @keyframes title-shine {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.01); } 
        }
        .title-animated {
            animation: title-shine 10s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes pulse-subtle {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2)); }
            50% { transform: scale(1.03); filter: drop-shadow(0 8px 25px rgba(0,0,0,0.3)); }
        }
        .animate-pulse-subtle {
            animation: pulse-subtle 3s infinite ease-in-out;
        }
        #ambient-light {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 6; 
            background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0) 70%);
            animation: slow-light-shift 40s ease-in-out infinite alternate;
        }
        @keyframes slow-light-shift {
            0% { transform: translate(0, 0); background: radial-gradient(circle at 55% 45%, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0) 70%); }
            100% { transform: translate(5%, 10%); background: radial-gradient(circle at 45% 55%, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0) 70%); }
        }
        .particle { 
            position: absolute; 
            background: rgba(212, 195, 166, 0.6); 
            border-radius: 50%; 
            opacity: 0; 
            animation: drift 20s infinite linear, rotate-subtle 10s infinite alternate; 
        }
        @keyframes drift {
            0% { transform: translate(-10vw, 0) rotate(0deg); opacity: 0; }
            5% { opacity: 0.7; }
            95% { opacity: 0.7; }
            100% { transform: translate(110vw, 50vh) rotate(360deg); opacity: 0; } 
        }
        @keyframes rotate-subtle {
            from { transform: rotate(0deg); }
            to { transform: rotate(180deg); }
        }
        
        /* --- ESTILO DEL TÍTULO PRINCIPAL (OSCURO Y CARVED) --- */
        #main-title {
            /* Color del texto: Marrón muy oscuro, casi negro */
            color: #4A3732; 
            
            /* Efecto de sombra para darle profundidad y hacerlo llamativo (Carved Look) */
            text-shadow: 
                0 1px 0 #D4C3A6, /* Sombra clara sutil arriba para simular relieve */
                0 2px 0 #D4C3A6,
                0 3px 0 #8A6D56, /* Sombra media para el cuerpo */
                0 4px 0 #8A6D56,
                0 5px 0 #6B4E3E, /* Sombra oscura profunda */
                0 6px 10px rgba(0, 0, 0, 0.5); /* Sombra de caída fuerte */

            /* Espaciado entre letras para un look más formal y monumental */
            letter-spacing: 0.1em; 
            z-index: 20; 
        }


        #explore-trigger {
            transition: all 0.3s ease, opacity 0.5s ease; 
        }
        #explore-trigger h3 {
            text-shadow: 0 0 10px #D0D0D0, 0 0 10px #D0D0D0, 0 0 15px #D0D0D0; 
            color: #4a4a4a; 
        }
        .island-container {
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
            filter: drop-shadow(5px 5px 10px rgba(74, 74, 74, 0.5)); 
            z-index: 10;
        }
        .island-container:hover {
            transform: translateY(-25px) scale(1.05) rotate(2deg); 
            filter: drop-shadow(10px 15px 30px rgba(0, 0, 0, 0.6)); 
            animation-play-state: paused;
        }
        .island-container.island-collapsed {
            top: 35% !important; 
            left: 50% !important;
            opacity: 0;
            visibility: hidden;
            transform: translate(-50%, -50%) scale(0.1) rotate(-45deg);
        }
        .modal-paper {
            background-color: #F8F5EE; 
            border: 4px solid #6B4E3E; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            background-image: url('imagenes/paper_texture.jpg'); 
            background-size: cover;
        }
        .tooltip { 
            visibility: hidden; 
            opacity: 0; 
            transform: translate(-50%, 10px); 
            transition: opacity 0.3s ease, transform 0.3s ease; 
            position: absolute; 
            bottom: 90%; 
            left: 50%; 
            z-index: 10; 
        }
        .group:hover .tooltip { 
            visibility: visible; 
            opacity: 1; 
            transform: translateX(-50%); 
        }
        .tooltip-bubble::after { 
            content: ''; 
            position: absolute; 
            top: 100%; 
            left: 50%; 
            margin-left: -8px; 
            border-width: 8px; 
            border-style: solid; 
            border-color: #6B4E3E transparent transparent transparent; 
        }
        
        /* --- AJUSTE DE ALTURA PARA ACOMODAR EL FOOTER --- */
        #world {
            position: relative;
            width: 100%;
            height: 110vh; 
        }
        
        /* --- ESTILOS DEL FOOTER --- */
        .footer-container {
            background-color: rgba(84, 57, 45, 0.9); 
            width: 100%;
            padding: 25px 10px; 
            text-align: center;
            z-index: 5; 
            margin-top: auto; 
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.3);
        }
        .logo-footer {
            width: 80px; 
            height: auto;
            margin-bottom: 10px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .footer-text {
            color: #D28D5D; 
            font-size: 13px;
            font-weight: 400;
            margin-top: 5px; 
        }

        /* Estilos específicos del fallback */
        .fallback-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            aspect-ratio: 16 / 9;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        .fallback-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.6;
        }
        .fallback-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #ff0000; 
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: bold;
            text-decoration: none;
            transition: background-color 0.3s, transform 0.3s;
        }
        .fallback-button:hover {
            background-color: #cc0000;
            transform: translate(-50%, -50%) scale(1.05);
        }
        
    </style>
</head>
<body class="bg-gradient-sky-desert min-h-screen w-full relative flex flex-col">

    <div class="w-full relative flex-grow">

        <h1 id="main-title" class="text-5xl md:text-7xl text-center pt-12 title-animated">
            ISLAS DE CONOCIMIENTO
        </h1>
        
        <div id="world" class="relative w-full"> 
            
            <div id="ambient-light"></div>

            <div id="explore-trigger" class="relative w-80 mx-auto mt-[10vh] cursor-pointer animate-pulse-subtle group z-20">
                <img src="imagenes/islaprincipal2.png" alt="Isla Central para Explorar" class="w-full">
                <h3 class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-4xl font-bold text-[#4a4a4a] pointer-events-none group-hover:scale-105 transition-transform">
                    INICIAR
                </h3>
            </div>

            <div id="reset-islands" class="hidden fixed top-6 right-6 z-50 text-5xl text-black cursor-pointer hover:text-red-500 hover:scale-110">
                &times;
            </div>

            <div 
                class="island-container group cursor-pointer absolute top-[35%] left-[40%] -translate-x-1/2 -translate-y-1/2 w-[250px] md:w-[350px] animate-float island-collapsed"
                style="animation-delay: 0s;"
                data-island-id="homo-sapiens"
            >
                <img src="imagenes/craneo2.png" alt="Isla del Cráneo" class="w-full">
                <div class="text-center text-xl md:text-2xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    HOMO SAPIENS
                </div>
                <div class="tooltip w-60">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">HOMO SAPIENS</p>
                        <p class="text-xs">El origen de nuestra especie.</p>
                    </div>
                </div>
            </div>
            
            <div 
                class="island-container group cursor-pointer absolute top-[10%] left-[15%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -2s;"
                data-island-id="bipedismo"
            >
                <img src="imagenes/bipedismo2.png" alt="Isla del Bipedismo" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    BIPEDISMO
                </div>
                <div class="tooltip w-60">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">BIPEDISMO</p>
                        <p class="text-xs">Característica clave de la evolución humana.</p>
                    </div>
                </div>
            </div>
            
            <div 
                class="island-container group cursor-pointer absolute top-[15%] right-[10%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -4s;"
                data-island-id="evolucion"
            >
                <img src="imagenes/evolutiva2.png" alt="Isla de la Línea Evolutiva" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    LÍNEA EVOLUTIVA
                </div>
                <div class="tooltip w-52">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">LÍNEA EVOLUTIVA</p>
                        <p class="text-xs">Nuestros ancestros.</p>
                    </div>
                </div>
            </div>
            
            <div 
                class="island-container group cursor-pointer absolute top-[55%] left-[10%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -1s;"
                data-island-id="herramientas"
            >
                <img src="imagenes/herramienta2.png" alt="Isla de Herramientas" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    HERRAMIENTAS
                </div>
                <div class="tooltip w-52">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">HERRAMIENTAS</p>
                        <p class="text-xs">La primera tecnología.</p>
                    </div>
                </div>
            </div>
            
            <div 
                class="island-container group cursor-pointer absolute top-[55%] right-[10%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -3s;"
                data-island-id="sociedad"
            >
                <img src="imagenes/sociedad2.png" alt="Isla de la Sociedad" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    SOCIEDAD
                </div>
                <div class="tooltip w-52">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">SOCIEDAD</p>
                        <p class="text-xs">Viviendo en comunidad.</p>
                    </div>
                </div>
            </div>

            <div 
                class="island-container group cursor-pointer absolute top-[80%] right-[20%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -5s;"
                data-island-id="fuego"
            >
                <img src="imagenes/fuego2.png" alt="Isla del Fuego" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    EL FUEGO
                </div>
                <div class="tooltip w-52">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">EL FUEGO</p>
                        <p class="text-xs">El control del fuego.</p>
                    </div>
                </div>
            </div>
            
            <div 
                class="island-container group cursor-pointer absolute top-[80%] left-[20%] w-[210px] md:w-[250px] animate-float island-collapsed"
                style="animation-delay: -2.5s;"
                data-island-id="arte"
            >
                <img src="imagenes/arte2.png" alt="Isla del Arte Rupestre" class="w-full">
                <div class="text-center text-lg md:text-xl text-black font-bold" style="text-shadow: 0 0 6px #C0C0C0, 0 0 6px #C0C0C0;">
                    ARTE RUPESTRE
                </div>
                <div class="tooltip w-52">
                    <div class="tooltip-bubble relative bg-white text-black text-center p-2 rounded-lg border-2 border-black">
                        <p class="text-sm font-bold">ARTE RUPESTRE</p>
                        <p class="text-xs">Primeras expresiones.</p>
                    </div>
                </div>
            </div>
            </div> 
        
        <div id="particles-container" class="absolute inset-0 w-full h-full overflow-hidden pointer-events-none z-10"></div>

    </div> 
    
    <footer class="footer-container">
        <img 
            src="imagenes/logo-dappicol-negro.png" 
            alt="Dappicol Logo" 
            class="logo-footer"
        >
        
        <p class="footer-text">
            © 2025 DAPPICOL. DESARROLLO WEB REALIZADO PARA EL PROYECTO APPIA — MEMORIAS ANCESTRALES.
        </p>
    </footer>

    <a href="../Pagina Principal/index.html" class="fixed bottom-6 left-6 z-40 bg-[#6B4E3E] hover:bg-[#4A3732] text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg">
        ⟵ Volver
    </a>

    
    <div id="modal-overlay" class="fixed inset-0 w-full h-full bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden">
        <div id="modal-content" class="modal-paper w-full max-w-4xl h-auto max-h-[90vh] p-6 md:p-10 relative overflow-y-auto">
            <button id="modal-close-btn" class="absolute top-4 right-5 text-4xl text-black hover:text-red-600 transition-colors">&times;</button>
            <h2 id="modal-title" class="text-3xl md:text-5xl text-center text-black mb-8"></h2>
            <div class="flex flex-col md:flex-row gap-8">
                <div class="w-full md:w-1/3 flex flex-col items-center">
                    
                    <div id="modal-media-container" class="mb-6 w-full max-w-[400px]"> 
                        <img src="imagenes/craneo2.png" alt="Imagen del modal" class="w-full" id="modal-image-placeholder">
                    </div>
                    <p id="video-embed-message" class="text-sm text-red-700 text-center mt-2 hidden">
                        **¡Atención!** El video no se puede incrustar debido a restricciones de YouTube. Por favor, haz clic en el botón rojo para verlo directamente en YouTube.
                    </p>
                    <div class="mb-4 mt-4">
                        <h3 id="modal-subtitle-1" class="text-xl md:text-2xl font-bold text-black uppercase"></h3>
                        <p id="modal-text-1" class="text-base md:text-lg text-gray-800"></p>
                    </div>
                </div>
                <div class="w-full md:w-2/3 space-y-4">
                    <div>
                        <h3 id="modal-subtitle-2" class="text-xl md:text-2xl font-bold text-black uppercase"></h3>
                        <p id="modal-text-2" class="text-base md:text-lg text-gray-800"></p>
                    </div>
                    <div>
                        <h3 id="modal-subtitle-3" class="text-xl md:text-2xl font-bold text-black uppercase"></h3>
                        <p id="modal-text-3" class="text-base md:text-lg text-gray-800"></p>
                    </div>
                    <div>
                        <h3 id="modal-subtitle-4" class="text-xl md:text-2xl font-bold text-black uppercase"></h3>
                        <p id="modal-text-4" class="text-base md:text-lg text-gray-800"></p>
                    </div>
                </div>
            </div>
            <div id="modal-citations-container" class="mt-8 pt-6 border-t-2 border-gray-400 border-dashed hidden">
                <h4 class="text-xl font-bold text-black mb-3">Fuentes y Referencias:</h4>
                <ul id="modal-citations-list" class="list-disc list-inside text-sm text-gray-700 space-y-1"></ul>
            </div>
        </div>
    </div>


    <script>
        // --- BASE DE DATOS DE CONTENIDO (CON IDs ORIGINALES Y 'FUEGO' LOCAL) ---
        const islandData = {
            'homo-sapiens': {
                title: "HOMO SAPIENS",
                image: "imagenes/craneo2.png", 
                video_id: "AhdGR1LlGeQ", 
                video_url: "https://www.youtube.com/watch?v=AhdGR1LlGeQ",
                sections: [
                    { title: "Qué es Homo sapiens", text: "La especie Homo sapiens agrupa a todos los humanos modernos que existen hoy día. Se caracteriza por un cráneo globular relativamente grande, una cara plana situada bajo el lóbulo frontal y la presencia de mentón en la mandíbula inferior." },
                    { title: "Origen y expansión", text: "Nuestra especie evolucionó en África hace aproximadamente 300 000 años y, en oleadas posteriores, se dispersó globalmente, pobló todos los continentes y reemplazó o se mezcló con otras especies de homínidos. humanorigins.si.edu+2Museo de Historia Natural+2" },
                    { title: "Anatomía y capacidades", text: "Se distingue por un cerebro de volumen medio alrededor de 1 330 cm³, cara pequeña y mandíbula menos prominente que en otras especies humanas antiguas. También posee un esqueleto adaptado a la bipedestación y manipulación refinada. Museo de Historia Natural" },
                    { title: "Cultura simbólica y tecnología", text: "Homo sapiens es la única especie conocida que desarrolló un lenguaje complejo, arte figurativo, ritos funerarios elaborados, cooperación social a gran escala y tecnología de herramientas variadas." }
                ],
                citations: [ { text: "Smithsonian Human Origins – Homo sapiens", url: "https://humanorigins.si.edu/evidence/human-fossils/species/homo-sapiens" } ]
            },
            'bipedismo': {
                title: "BIPEDISMO",
                image: "imagenes/bipedismo2.png", 
                video_id: "oDOgIH9jj5g", 
                video_url: "https://www.youtube.com/watch?v=oDOgIH9jj5g",
                sections: [
                    { title: "¿Qué es el bipedalismo?", text: "El bipedalismo se refiere a la locomoción habitual sobre dos piernas. Uno de los rasgos distintivos del linaje humano es andar erguido sobre dos extremidades inferiores." },
                    { title: "Origen evolutivo", text: "Los primeros indicios de locomoción bípeda en homínidos datan de hace unos 6 a 7 millones de años, y se observa una adaptación progresiva del esqueleto para caminar erectos." },
                    { title: "Cambios anatómicos", text: "Cambios como el foramen magnum más hacia adelante, la curvatura de la columna, adaptación de pies con arco, pelvis y extremidades modificadas acompañaron el paso al bipedalismo." },
                    { title: "Importancia evolutiva", text: "Caminar en dos piernas liberó las manos para manipular objetos, facilitó la vigilancia, la movilidad eficiente en sabana y posiblemente favoreció el desarrollo de cerebros mayores y cooperación social." }
                ],
                citations: [ { text: "Australian Museum – Bipedalism", url: "https://australian.museum/learn/science/human-evolution/walking-on-two-legs-bipedalism/" } ]
            },
            'evolucion': {
                title: "LÍNEA EVOLUTIVA",
                image: "imagenes/evolutiva2.png", 
                video_id: "4l1PYBkG4dc", 
                video_url: "https://www.youtube.com/watch?v=4l1PYBkG4dc",
                sections: [
                    { title: "Origen de los homínidos", text: "La evolución humana comenzó con la divergencia del linaje de los grandes simios hace unos 6-7 millones de años en África. Encyclopedia Britannica+2Wikipedia+2" },
                    { title: "Género Homo y ramificación evolutiva", text: "El género Homo surge hace aproximadamente 2.8-2.5 millones de años, dando paso a diversas especies humanas que se ramificaron, como Homo erectus o Homo heidelbergensis, antes de la aparición de Homo sapiens. Wikipedia+1" },
                    { title: "Migraciones y expansión global", text: "Los primeros Homo erectus salieron de África hace aproximadamente 1.8 millones de años, lo que marcó el inicio de la dispersión humana fuera del continente originario. Becoming Human+1" },
                    { title: "Evolución reciente y humanos modernos", text: "Homo sapiens aparece hace alrededor de 300 000 años en África y, mediante múltiples oleadas migratorias, pobló todos los continentes, reemplazando o mezclándose con otras especies humanas arcaicas. Museo de Historia Natural+1" }
                ],
                citations: [ { text: "Britannica – Human evolution", url: "https://www.britannica.com/science/human-evolution" } ] 
            },
            'herramientas': {
                title: "HERRAMIENTAS",
                image: "imagenes/herramienta2.png", 
                video_id: "M2NQ9Hy4kKs", 
                video_url: "https://www.youtube.com/watch?v=M2NQ9Hy4kKs",
                sections: [
                    { title: "¿Qué son las herramientas prehistóricas?", text: "Las herramientas de piedra y otros artefactos nos ofrecen pistas de cómo vivían, interactuaban y se adaptaban nuestros antepasados humanos. humanorigins.si.edu" },
                    { title: "Primeras herramientas y evolución tecnológica", text: "Los artefactos más antiguos conocidos datan de hace unos 3.3 millones de años; hacia 1.75 millones de años ya existía la tecnología “Acheuleana” con hachas grandes. Smithsonian Magazine" },
                    { title: "Impacto en el comportamiento humano", text: "El desarrollo y uso de herramientas permitió una mayor eficacia en la obtención de alimentos, lo que contribuyó a cambios anatómicos y sociales en el linaje humano. Encyclopedia Britannica+1" },
                    { title: "Herramientas y la simbología emergente", text: "Además de su función práctica, las herramientas comenzaron a formar parte de la cultura simbólica humana, vinculadas con modos de vida, cooperación y enseñanza entre generaciones. humanorigins.si.edu+1" }
                ],
                citations: [ { text: "Smithsonian Human Origins – Stone Tools", url: "https://humanorigins.si.edu/evidence/behavior/stone-tools" } ]
            },
            'sociedad': {
                title: "SOCIEDAD",
                image: "imagenes/sociedad2.png", 
                video_id: "GD0UlmnpJMA", 
                video_url: "https://www.youtube.com/watch?v=GD0UlmnpJMA",
                sections: [
                    { title: "Vida social de los primeros humanos", text: "Compartir alimentos, cuidar de los recién nacidos y construir redes sociales fueron adaptaciones clave para que nuestros antepasados enfrentaran los retos de su entorno. humanorigins.si.edu+1" },
                    { title: "Estructura social y cooperación", text: "A diferencia de otros primates, los humanos desarrollaron redes de cooperación extensas, estructuras sociales más complejas y un período juvenil prolongado, lo que permitió aprendizajes y transmisión cultural. Becoming Human+1" },
                    { title: "Evolución del entorno social y cultural", text: "Con el tiempo, las sociedades humanas pasaron de grupos pequeños y móviles a estructuras más elaboradas, con roles definidos, mayor tamaño grupal y estrategia colectiva. patrickmanningworldhistorian.com+1" },
                    { title: "Sociedad y cultura humana moderna", text: "La creciente complejidad social permitió el desarrollo del lenguaje, la simbología, el intercambio cultural y la colaboración a gran escala — elementos que definen lo que somos hoy. humanorigins.si.edu+1" }
                ],
                citations: [ { text: "Smithsonian Human Origins – Social Life", url: "https://humanorigins.si.edu/human-characteristics/social-life" } ]
            },
            'fuego': {
                title: "EL FUEGO",
                image: "imagenes/fuego2.png", 
                video_id: "LerWOXj5D9Q&t=1s", 
                video_url: "https://www.youtube.com/watch?v=LerWOXj5D9Q&t=1s",
                // ESTE SE MANTIENE LOCAL
                sections: [
                    { title: "El control del fuego", text: "El dominio del fuego fue un hito evolutivo clave: permitió a los humanos calentar espacios, cocinar alimentos, protegerse de depredadores y expandirse a zonas frías. royalsocietypublishing.org+1" },
                    { title: "Cronología del uso del fuego", text: "Hay evidencias de sedimentos quemados controlados hace más de 1 millón de años; el uso sistemático del fuego y los hogares parecen establecerse hace aproximadamente 400 000-800 000 años. si.edu+1" },
                    { title: "Impacto en biología y cultura humana", text: "Cocinar alimentos convirtió nutrientes más accesibles, redujo desgaste dental, facilitó el desarrollo del cerebro, y el fuego permitió más horas de actividad y sociabilidad nocturna. Encyclopedia Britannica" },
                    { title: "Fuego, tecnología y simbolismo", text: "Más allá de su función práctica, el fuego pasó a tener significado cultural, ritual y social; fue partícipe en la forja de la vida comunitaria y en la transformación del Homo sapiens." }
                ],
                citations: [ { text: "Royal Society Publishing – The discovery of fire", url: "https://royalsocietypublishing.org/doi/10.1098/rstb.2015.0164" } ]
            },
            'arte': {
                title: "ARTE RUPESTRE",
                image: "imagenes/arte2.png", 
                video_id: "m_ef1VPF158", 
                video_url: "https://www.youtube.com/watch?v=m_ef1VPF158",
                sections: [
                    { title: "¿Qué es el arte rupestre?", text: "El arte rupestre se refiere a pinturas y grabados hallados en cuevas y refugios, principalmente del periodo Paleolítico entre hace aproximadamente 40 000 y 14 000 años. Encyclopedia Britannica" },
                    { title: "Ubicación y significado cultural", text: "Muchas obras se encuentran en Europa (Francia, España) pero también en otras partes del mundo; representan animales, figuras humanas, signos simbólicos, y sugieren que la mente humana ya creaba representaciones abstractas. The Art Story" },
                    { title: "Técnicas y materiales usados", text: "Pigmentos como óxidos de hierro (rojos), manganeso o carbón (negros) se utilizaron para pinturas; también se hicieron grabados con herramientas de sílex o dedos. Encyclopedia Britannica" },
                    { title: "Importancia en la historia humana", text: "El arte rupestre revela capacidades simbólicas, narrativas y culturales de nuestros antepasados; es testimonio de que la expresión, el pensamiento y la creatividad humana existían desde hace decenas de miles de años. Google Arts & Culture" }
                ],
                citations: [ { text: "Britannica – Cave Art", url: "https://www.britannica.com/art/cave-art" } ]
            }
        };

        // --- LÓGICA DEL MODAL ---
        const modalOverlay = document.getElementById('modal-overlay');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const modalTitle = document.getElementById('modal-title');
        // Cambié a 'modal-media-container'
        const modalMediaContainer = document.getElementById('modal-media-container'); 
        const videoEmbedMessage = document.getElementById('video-embed-message'); // Nuevo elemento
        
        const modalSubtitle1 = document.getElementById('modal-subtitle-1');
        const modalText1 = document.getElementById('modal-text-1');
        const modalSubtitle2 = document.getElementById('modal-subtitle-2');
        const modalText2 = document.getElementById('modal-text-2');
        const modalSubtitle3 = document.getElementById('modal-subtitle-3');
        const modalText3 = document.getElementById('modal-text-3');
        const modalSubtitle4 = document.getElementById('modal-subtitle-4');
        const modalText4 = document.getElementById('modal-text-4');
        const modalCitationsContainer = document.getElementById('modal-citations-container');
        const modalCitationsList = document.getElementById('modal-citations-list');

        function openModal(islandId) {
            const data = islandData[islandId];
            if (!data) return;

            // Limpiar contenido previo
            modalMediaContainer.innerHTML = ''; 
            videoEmbedMessage.classList.add('hidden'); // Ocultar mensaje de error por defecto
            
            modalMediaContainer.classList.add('flex', 'justify-center', 'items-center');
            modalMediaContainer.classList.remove('w-[150px]', 'md:w-[200px]'); 
            
            modalTitle.textContent = data.title;


            if (data.video_id) {
                // Caso general: Video de YouTube
                
                const embedUrl = `https://www.youtube.com/embed/${data.video_id}?autoplay=1&rel=0`;
                
                // 1. Intentar cargar el IFRAME (puede fallar con Error 153)
                const iframeHtml = `
                    <iframe 
                        id="youtube-iframe"
                        class="w-full h-full rounded-lg shadow-xl" 
                        style="aspect-ratio: 16 / 9; max-width: 400px; max-height: 250px;" 
                        src="${embedUrl}" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                        allowfullscreen
                        title="${data.title} Video"
                        referrerpolicy="strict-origin-when-cross-origin" 
                    ></iframe>
                `;
                modalMediaContainer.innerHTML = iframeHtml;

                // 2. Implementar el FALLBACK (el video no se carga/restringido)
                const iframe = document.getElementById('youtube-iframe');
                
                // YouTube no da un error estándar al fallar el embed por restricción de contenido,
                // así que esperamos un tiempo prudente, y si el iframe está vacío (lo que YouTube hace al fallar el embed),
                // mostramos el fallback.
                setTimeout(() => {
                    // Verificar si el iframe sigue cargando o si la restricción ha sido aplicada
                    try {
                        // Acceder a contentWindow para verificar (a menudo falla por CORS, pero a veces es suficiente)
                        if (iframe.contentWindow.document.body.innerHTML === "") {
                             throw new Error("Embedded video failed to load content.");
                        }
                    } catch (e) {
                        // El video no se cargó correctamente (debido a restricción o CORS). Activar Fallback.
                        
                        // Generamos la URL de la miniatura de alta calidad
                        const thumbnailUrl = `https://img.youtube.com/vi/${data.video_id}/maxresdefault.jpg`;
                        
                        modalMediaContainer.innerHTML = `
                            <div class="fallback-container">
                                <img src="${thumbnailUrl}" alt="Miniatura del video de ${data.title}" class="fallback-image">
                                <a href="${data.video_url}" target="_blank" rel="noopener noreferrer" class="fallback-button">
                                    ▶️ Ver Video en YouTube
                                </a>
                            </div>
                        `;
                        videoEmbedMessage.classList.remove('hidden'); // Mostrar mensaje de error
                    }
                }, 3000); // Dar 3 segundos para intentar cargar el iframe

                
            } else if (data.image) {
                // Caso de solo imagen (si no hay ni video local ni de YouTube)
                modalMediaContainer.innerHTML = `<img src="${data.image}" alt="Imagen del modal" class="w-full">`;
                modalMediaContainer.classList.remove('flex', 'justify-center', 'items-center');
            } else {
                 modalMediaContainer.innerHTML = `<p>No hay contenido multimedia disponible.</p>`;
                 modalMediaContainer.classList.remove('flex', 'justify-center', 'items-center');
            }
            
            
            // Llenar contenido de texto
            modalSubtitle1.textContent = data.sections[0].title;
            modalText1.textContent = data.sections[0].text;
            modalSubtitle2.textContent = data.sections[1].title;
            modalText2.textContent = data.sections[1].text;
            modalSubtitle3.textContent = data.sections[2].title;
            modalText3.textContent = data.sections[2].text;
            
            if(data.sections[3]) {
                modalSubtitle4.textContent = data.sections[3].title;
                modalText4.textContent = data.sections[3].text;
                modalSubtitle4.parentElement.style.display = 'block';
            } else {
                modalSubtitle4.parentElement.style.display = 'none';
            }
            
            // Manejo de citaciones
            modalCitationsList.innerHTML = '';
            let allCitations = [...(data.citations || [])];
            
            if (data.video_url && data.video_url !== '#') {
                allCitations.push({ 
                    text: `Video de YouTube: ${data.title}`, 
                    url: data.video_url 
                });
            }

            if (allCitations.length > 0) {
                allCitations.forEach(citation => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.textContent = citation.text;
                    a.href = citation.url;
                    a.target = "_blank"; 
                    a.rel = "noopener noreferrer";
                    a.className = "text-blue-700 hover:text-blue-900 hover:underline";
                    li.appendChild(a); 
                    modalCitationsList.appendChild(li);
                });
                modalCitationsContainer.classList.remove('hidden');
            } else {
                modalCitationsContainer.classList.add('hidden');
            }
            
            modalOverlay.classList.remove('hidden');
            modalOverlay.style.display = 'flex';
        }

        function closeModal() {
            // Detener la reproducción del video de YouTube (iframe)
            const iframeElement = modalMediaContainer.querySelector('iframe');
            if (iframeElement) {
                iframeElement.src = ""; // Borrar la fuente para detener el video de YouTube
            }
            
            // Detener la reproducción del video local (video tag)
            const videoElement = modalMediaContainer.querySelector('video');
            if (videoElement) {
                videoElement.pause();
                videoElement.currentTime = 0;
            }
            
            modalOverlay.classList.add('hidden');
            setTimeout(() => { modalOverlay.style.display = 'none'; }, 300); 
        }

        modalCloseBtn.addEventListener('click', closeModal);
        modalOverlay.addEventListener('click', (event) => {
            if (event.target === modalOverlay) closeModal();
        });
        
        // --- LÓGICA DE PARTÍCULAS ---
        const particlesContainer = document.getElementById('particles-container');
        const numParticles = 50;
        for (let i = 0; i < numParticles; i++) {
            let particle = document.createElement('div');
            particle.className = 'particle';
            const size = Math.random() * 3 + 1;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.top = `${Math.random() * 100}vh`;
            particle.style.left = `${Math.random() * 100}vw`;
            particle.style.animationDelay = `${Math.random() * 20}s`;
            particle.style.animationDuration = `${Math.random()* 10 + 10}s`;
            particlesContainer.appendChild(particle);
        }

        // --- LÓGICA PARA EL DESPLIEGUE DE ISLAS ---
        document.addEventListener('DOMContentLoaded', () => {
            const exploreTrigger = document.getElementById('explore-trigger');
            const resetIslandsBtn = document.getElementById('reset-islands');
            const islandContainers = document.querySelectorAll('.island-container');

            // 1. Abrir las islas
            exploreTrigger.addEventListener('click', () => {
                exploreTrigger.style.opacity = '0'; 
                setTimeout(() => {
                    exploreTrigger.classList.add('hidden'); 
                }, 500); 
                
                resetIslandsBtn.classList.remove('hidden'); 

                islandContainers.forEach((island, index) => {
                    setTimeout(() => {
                        island.classList.remove('island-collapsed');
                    }, 500 + (index * 150)); 
                });
            });

            // 2. Cerrar las islas
            resetIslandsBtn.addEventListener('click', () => {
                exploreTrigger.classList.remove('hidden'); 
                exploreTrigger.style.opacity = '1';
                resetIslandsBtn.classList.add('hidden'); 

                islandContainers.forEach(island => {
                    island.classList.add('island-collapsed'); 
                });
            });

            // 3. Asignar el clic para abrir el modal
            islandContainers.forEach(island => {
                island.addEventListener('click', () => {
                    if (!island.classList.contains('island-collapsed')) {
                        const islandId = island.dataset.islandId;
                        openModal(islandId);
                    }
                });
            });
        });

    </script>
</body>
</html>
